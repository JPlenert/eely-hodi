// Eely-HoDi - (c) 2022-24 by Joerg Plenert | https://eely.eu
#include "MatrixFontCommon.h"
#include "Display.h"
#include "esp_log.h"

unsigned char matrix7_bitmap[] = { 
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XXXXXXXX,
                    _XXXXXX_,
                    8,
                    ______X_, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    ______XX, 
                    _______X,
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    _XXXXXXX,
                    XXXXXXX_,
                    XX______,
                    XX______,
                    XX______,
                    XX______,
                    XX______,
                    XXXXXXXX,
                    _XXXXXX_,
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    _XXXXXXX,
                    XXXXXXXX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    XXXXXXXX,
                    _XXXXXX_,
                    8,
                    X______X, 
                    XX____XX, 
                    XX____XX, 
                    XX____XX, 
                    XX____XX, 
                    XX____XX, 
                    XX____XX, 
                    XXXXXXXX,
                    XXXXXXX_,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    _______X,
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    XX______,
                    XX______,
                    XX______,
                    XX______,
                    XX______,
                    XXXXXXX_,
                    XXXXXXXX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    XXXXXXXX,
                    _XXXXXX_,
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    XX____XX,
                    XX______,
                    XX______,
                    XX______,
                    XX______,
                    XXXXXXX_,
                    XXXXXXXX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XXXXXXXX,
                    _XXXXXX_,
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______X_,
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    _XXXXXX_,
                    _XXXXXX_,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XXXXXXXX,
                    _XXXXXX_,
                    8,
                    _XXXXXX_, 
                    XXXXXXXX, 
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    XX____XX,
                    _XXXXXXX,
                    _XXXXXXX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    ______XX,
                    XXXXXXXX,
                    _XXXXXX_,
                    2,
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    XX______, 
                    XX______, 
                    ________, 
                    ________, 
                    XX______, 
                    XX______, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________,                     
                    2,
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    XX______, 
                    XX______, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________,                       
                    2,
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    XX______, 
                    XX______, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    ________, 
                    };

void Segment7_Draw(int x, int y, int len, int* digits, const rgb24& color)
{
    for (int charIdx=0; charIdx<len; charIdx++)
    {
        // Check for spacing
        if (digits[charIdx] == -1)
        {
            x++;
            continue;
        }

        int bitmapIdx = digits[charIdx] * (16+1);
        int charWidth = matrix7_bitmap[bitmapIdx++];

        for (int lineIdx=0; lineIdx<16; lineIdx++)
        {
            int digitLineToPrint = matrix7_bitmap[bitmapIdx++];
            int mask = 0x80;

            for (int colIdx=0; colIdx<charWidth; colIdx++)
            {
                if (digitLineToPrint & mask)
                {
                    backgroundLayer.drawPixel(x + colIdx, y + lineIdx, color);
                }

                mask >>= 1;
            }
        }
        x += charWidth+1;
    }
}                    